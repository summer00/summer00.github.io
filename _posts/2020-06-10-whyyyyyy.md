---
title: "十万个为什么"
date: 2020-06-10 23:30:00 +0800
categories: [other]
---

本文记录一些突然很想知道的问题，可能是某个功能的实现细节，可能是某个框架的运行原理，也可能是某个事件的来龙去脉等等。反正，应该会是一些奇奇怪怪的东西吧～

# 框架

## MyBaits 插入后如何得到生成的主键 id 的

MyBaits 中的`SqlRunner`封装了`PreparedStatement`，在`insert`方法中，调用了`Statement.getGeneratedKeys()`，然后循环将生成的主键返回。

```java
    /**
     * Retrieves any auto-generated keys created as a result of executing this
     * <code>Statement</code> object. If this <code>Statement</code> object did
     * not generate any keys, an empty <code>ResultSet</code>
     * object is returned.
     *
     *<p><B>Note:</B>If the columns which represent the auto-generated keys were not specified,
     * the JDBC driver implementation will determine the columns which best represent the auto-generated keys.
     *
     * @return a <code>ResultSet</code> object containing the auto-generated key(s)
     *         generated by the execution of this <code>Statement</code> object
     * @exception SQLException if a database access error occurs or
     * this method is called on a closed <code>Statement</code>
     * @throws SQLFeatureNotSupportedException  if the JDBC driver does not support this method
     * @since 1.4
     */
    ResultSet getGeneratedKeys() throws SQLException;
```
